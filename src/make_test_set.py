import os
import random
import subprocess

def check_dir(target_path) :
    if target_path[-1] == "/" :
        target_path = target_path[:-1]
    dir_list = target_path.split("/")
    path_to_make = dir_list[0] + "/"
    for comp in dir_list[1:] :
        path_to_make += "%s/" % comp
        if not os.path.exists(path_to_make) :
            os.mkdir(path_to_make)

train_ratio = 0.7
malware_train_set_path = "../data_set/malware_train/"
benign_train_set_path = "../data_set/benign_train/"
malware_test_set_path = "../data_set/malware_test/"
benign_test_set_path = "../data_set/benign_test/"
check_dir(malware_train_set_path)
check_dir(malware_test_set_path)
check_dir(benign_train_set_path)
check_dir(benign_test_set_path)

malware_path = "../resource/malware_dynamic/"
benign_path = "../resource/benign_dynamic/"
malware_path_list = [malware_path+target for target in os.listdir(malware_path)]
benign_path_list = [benign_path+target for target in os.listdir(benign_path)]

random.shuffle(malware_path_list)
random.shuffle(benign_path_list)

malware_divider = int(len(malware_path_list)*train_ratio)
benign_divider = int(len(benign_path_list)*train_ratio)

for target in malware_path_list[:malware_divider] :
    subprocess.call(["cp", target, malware_train_set_path])
for target in benign_path_list[:benign_divider] :
    subprocess.call(["cp", target, benign_train_set_path])
for target in malware_path_list[malware_divider:] :
    subprocess.call(["cp", target, malware_test_set_path])
for target in benign_path_list[benign_divider:] :
    subprocess.call(["cp", target, benign_test_set_path])
