import pefile
import sys
import os
import subprocess

if len(sys.argv) != 2 :
    print("the number of arguments should be 2")
    exit(1)
if not os.path.exists("../resource/not_pe/") :
    os.mkdir("../resource/not_pe/")

path = sys.argv[1]
file_list = [path + f for f in os.listdir(path)]

for file_path in file_list :
    with open(file_path, mode="rb") as f :
        header = f.read(16)
        if header[:2] != b"\x4d\x5a" :
            print("%-60s is not PE file.  file header => %30s" % (file_path, header))
            subprocess.call(["mv", file_path, "../resource/not_pe/"])



